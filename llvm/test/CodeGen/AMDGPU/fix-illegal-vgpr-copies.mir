# RUN: not --crash llc -march=amdgcn -mcpu=gfx1200 -run-pass=machineverifier %s 2>&1 | FileCheck -check-prefix=ERR %s

---
name: fix-illegal-copies
tracksRegLiveness: true
machineFunctionInfo:
  isEntryFunction: true
body:             |
  bb.0:
    %0:vgpr_32 = IMPLICIT_DEF
    %0:vgpr_32 = IMPLICIT_DEF ; Break SSA format
    %1:vgpr_32 = IMPLICIT_DEF
    %2:sgpr_32 = IMPLICIT_DEF
    %3:sgpr_32 = IMPLICIT_DEF

    ; ERR: *** Bad machine code: illegal copy from VGPR to SGPR ***
    ; ERR: instruction: %4:sgpr_32 = COPY %0:vgpr_32
    %4:sgpr_32 = COPY %0:vgpr_32

    ; ERR: *** Bad machine code: illegal copy from VGPR to SGPR ***
    ; ERR: instruction: $sgpr0 = COPY %0:vgpr_32
    $sgpr0 = COPY %0:vgpr_32
    
    ; ERR: *** Bad machine code: illegal copy from VGPR to SGPR ***
    ; ERR: instruction: $sgpr1 = COPY $vgpr0
    $sgpr1 = COPY $vgpr0

    S_ENDPGM 0
...
